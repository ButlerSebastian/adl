{
  "version": 3,
  "version_string": "3.0.0",
  "lifecycle": {
    "status": "active",
    "created_at": "2025-02-16T10:00:00Z",
    "last_updated": "2025-02-16T10:00:00Z"
  },
  "name": "resource_policy_agent",
  "description": "Agent with resource-based access control policy",
  "role": "Secure Agent",
  "llm": "openai",
  "llm_settings": {
    "temperature": 0.7,
    "max_tokens": 2000
  },
  "policy": {
    "id": "resource-policy",
    "name": "Resource-Based Policy",
    "version": "1.0.0",
    "description": "Resource-based access control policy with fine-grained permissions",
    "rego": "package authz\n\ndefault allow := false\n\nallow if {\n    input.resource == \"database\"\n    input.action in data.resources[\"database\"]\n    has_permission(input.user, input.resource, input.action)\n}\n\nallow if {\n    input.resource == \"api\"\n    input.action in data.resources[\"api\"]\n    has_permission(input.user, input.resource, input.action)\n}\n\nallow if {\n    input.resource == \"files\"\n    input.action in data.resources[\"files\"]\n    has_permission(input.user, input.resource, input.action)\n}\n\nhas_permission(user, resource, action) {\n    data.permissions[user][resource][action]\n}",
    "enforcement": {
      "mode": "strict",
      "action": "deny",
      "audit_log": true
    },
    "data": {
      "resources": {
        "database": ["read", "write", "delete"],
        "api": ["read", "write"],
        "files": ["read", "write", "delete"]
      },
      "permissions": {
        "alice": {
          "database": ["read", "write", "delete"],
          "api": ["read", "write"],
          "files": ["read", "write", "delete"]
        },
        "bob": {
          "database": ["read", "write"],
          "api": ["read"],
          "files": ["read"]
        },
        "charlie": {
          "database": ["read"],
          "api": ["read"],
          "files": ["read"]
        }
      }
    },
    "metadata": {
      "author": "security-team",
      "tags": ["rbac", "resource-based", "access-control"]
    }
  },
  "tools": [
    {
      "name": "read_database",
      "description": "Read from database",
      "category": "database.read",
      "parameters": [
        {
          "name": "query",
          "type": "string",
          "description": "SQL query",
          "required": true
        }
      ],
      "returns": {
        "type": "QueryResult",
        "description": "Returns query results"
      },
      "invocation": { "type": "python_function" }
    },
    {
      "name": "write_database",
      "description": "Write to database",
      "category": "database.write",
      "parameters": [
        {
          "name": "query",
          "type": "string",
          "description": "SQL query",
          "required": true
        }
      ],
      "returns": {
        "type": "SuccessResult",
        "description": "Returns success status"
      },
      "invocation": { "type": "python_function" }
    },
    {
      "name": "call_api",
      "description": "Call external API",
      "category": "api.call",
      "parameters": [
        {
          "name": "endpoint",
          "type": "string",
          "description": "API endpoint",
          "required": true
        },
        {
          "name": "method",
          "type": "string",
          "description": "HTTP method",
          "enum": ["GET", "POST", "PUT", "DELETE"],
          "required": true
        }
      ],
      "returns": {
        "type": "APIResult",
        "description": "Returns API response"
      },
      "invocation": { "type": "python_function" }
    },
    {
      "name": "read_file",
      "description": "Read file",
      "category": "file.read",
      "parameters": [
        {
          "name": "path",
          "type": "string",
          "description": "File path",
          "required": true
        }
      ],
      "returns": {
        "type": "FileResult",
        "description": "Returns file contents"
      },
      "invocation": { "type": "python_function" }
    },
    {
      "name": "write_file",
      "description": "Write file",
      "category": "file.write",
      "parameters": [
        {
          "name": "path",
          "type": "string",
          "description": "File path",
          "required": true
        },
        {
          "name": "content",
          "type": "string",
          "description": "File content",
          "required": true
        }
      ],
      "returns": {
        "type": "SuccessResult",
        "description": "Returns success status"
      },
      "invocation": { "type": "python_function" }
    }
  ],
  "rag": [],
  "memory": {
    "type": "episodic",
    "scope": "session",
    "backend": "sqlite",
    "retention_days": 30,
    "policies": {
      "max_entries": 1000,
      "max_size_mb": 100
    },
    "privacy": {
      "encryption": true,
      "anonymization": false
    }
  },
  "permissions": {
    "file_io": {
      "read": true,
      "write": true,
      "allowed_paths": ["/workspace/*"]
    },
    "network": {
      "enabled": true,
      "allowed_domains": ["api.example.com", "database.example.com"]
    },
    "env_vars": {
      "allowed": ["API_KEY", "DB_PASSWORD"]
    }
  },
  "dependencies": {
    "python": [
      {
        "name": "requests",
        "version": ">=2.28.0"
      },
      {
        "name": "opa",
        "version": ">=0.46.0"
      },
      {
        "name": "psycopg2",
        "version": ">=2.9.0"
      }
    ]
  },
  "governance": {
    "owner": "security-team",
    "compliance": ["SOC2", "GDPR"],
    "audit_log": true,
    "change_log": [
      {
        "version": "3.0.0",
        "date": "2025-02-16",
        "changes": [
          "Added resource-based access control policy",
          "Implemented fine-grained permissions for database, API, and files"
        ]
      }
    ]
  }
}
